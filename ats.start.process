
  +-------+
  | main  |
  +-------+
   
      +-------------------------------------------+
      | init_HttpProxyServer(num_accept_threads); |
      +-------------------------------------------+

      +-----------------------+
      | MakeHttpProxyAcceptor |
      +-----------------------+

      +------------+
      | HttpAccept |
      +------------+

      +--------------------------------------------+
      |HttpAccept::mainEvent(int event, void *data)|
      +--------------------------------------------+

      +---------------------------------------------------------------------------+
      | HttpClientSession::new_connection(NetVConnection * new_vc, bool backdoor) |
      +---------------------------------------------------------------------------+

      +---------------------------------------------------+
      |HttpClientSession::do_api_callout(TSHttpHookID id) |
      +---------------------------------------------------+
      +-------------------------------------------------+
      | HttpClientSession::handle_api_return(int event) |
      +-------------------------------------------------+
      +-----------------------------------------+
      | HttpClientSession::new_transaction()    | ***IMPORTANT****
      +-----------------------------------------+
      +--------------------+
      | HttpSM::allocate() |
      +--------------------+

      +--------------------------+
      | httpSMAllocator.alloc()  |
      +--------------------------+





